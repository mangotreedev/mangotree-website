<!DOCTYPE html>
<html>
<head>
  <!-- Google Optimze Snippet -->
  <script src="https://www.googleoptimize.com/optimize.js?id=OPT-MTK326C"></script>
  <!-- End Google Optimze Snippet -->
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-5SQ86FP');</script>
  <!-- End Google Tag Manager -->

  <title>Custom & Vanity URLs with Rails</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="description"
    content="An agency at the cross section of design & development. We use lean design and agile development to help entrepreneurs build the right tech products.">

  <meta name="author" content="MangoTree Dev">
  <meta name="keywords"
    content="Design Agency, Tech, Lean Design, Innovation, Web Development, Startups, Marketing">
  <link rel="icon" type="image/png"
    href="https://res.cloudinary.com/nico1711/image/upload/c_scale,h_32/v1599284743/__Full_Colour_-_Icon_Only_qq727e.png">

  <!--  Social media meta tags -->
  <meta property="og:title" content="MangoTree Dev" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://www.mangotree.dev" />
  <meta property="og:image"
    content="https://res.cloudinary.com/nico1711/image/upload/c_scale,w_1200/v1601000951/website_preview.png" />
  <meta property="og:description"
    content="An agency at the cross section of design & development. We use lean design and agile development to help entrepreneurs build the right tech products." />
  <meta property="og:site_name" content="MangoTree Dev" />
</head>
<body>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5SQ86FP"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  <div class="responsive-overlay">
    <div class="responsive-overlay__phone-container">
      <div class="phone-container__phone-item">
        <i class="fa fa-repeat"></i>
      </div>
      <p>Rotate your device!</p>
    </div>
  </div>

  <div class="share-dropdown js-share-menu">
    <li>
      <i class="fas fa-link js-copy-link"></i>
      <p class="share-dropdown__tooltip">Link copied!</p>
    </li>
    <li>
      <a href="#" onclick="window.open('https://www.linkedin.com/shareArticle?mini=true&url=' + encodeURIComponent(document.URL))" target="_blank">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a href="#" onclick="window.open('https://twitter.com/intent/tweet?text=%20Check%20this%20out%20-%20' + encodeURIComponent(document.title) + ':%20 ' + encodeURIComponent(document.URL));" >
        <i class="fab fa-twitter"></i>
      </a>
    </li>

  </div>

  <div class="page-content">
    <div class="burger-icon js-navbar-icon">
      <div class="burger-icon__middle"></div>
    </div>

    <div class="navbar-menu">
      <img class="navbar-menu__logo" src="https://res.cloudinary.com/nico1711/image/upload/v1598498149/__Black_Outline_-_Icon_Only_pzxuwn.png" alt="">
      <ul class="navbar-menu__links-list js-links-list">
        <li><a href="/#skills">SKILLS</a></li>
        <li><a href="/#team">OUR TEAM</a></li>
        <li><a href="/#portfolio">PORTFOLIO</a></li>
        <li><a href="/blog.html">BLOG</a></li>
        <li><a href="/resources.html">RESOURCES</a></li>
        <li><a href="/#contact" class="js-contact-btn">CONTACT</a></li>
        <li><a href="#" class="js-navbar-dark">DARK MODE</a></li>
      </ul>
      <a href="mailto:hello@mangotree.dev" class="navbar-menu__contact">
        <i class="far fa-envelope"></i>
        hello@mangotree.dev
      </a>
    </div>

    <div class="post-container">
      <div class="post-sidebar__wrapper">
        <div class="post-sidebar">
          <p class="js-share-btn share-btn">SHARE <i class="fas fa-share-alt"></i></p>
          <a href="/blog.html"><span>â†</span> BACK TO BLOG</a>
        </div>
      </div>

      <div class="post-content">
        <img src="https://res.cloudinary.com/nico1711/image/upload/v1626882449/MangoTree%20Website/articles/custom-and-vainity-urls-rails.jpg" alt="Mc Loving gif" class="post-content__banner">
        <div class="post-content__header">
          <h2>Custom & Vanity URLs with Rails</h2>
          <div class="post-content__header-info">
            <div class="post-content__header-info-left">
              <img src="https://res.cloudinary.com/nico1711/image/upload/v1626803393/MangoTree%20Website/sy-rashid-profile.jpg" alt="sy avatar">
              <p class="p_size_s"><span>Written by</span> Sy Rashid</p>
            </div>
            <div class="post-content__header-info-right">
              <p class="p_size_s">Dec 20 Â· 9 min read</p>
              <p class="js-share-btn share-btn"><i class="fas fa-share-alt"></i></p>
            </div>
          </div>
        </div>

        <div class="post-content__body">
          <markdown>
            Imagine youâ€™re 40, no need for those IDs at the bar anymore ğŸ‘´ğŸ»

            ![](https://miro.medium.com/max/1000/0*AMTFHT33FNuU5ovv.gif)

            It all started with a student asking how to create invite links for groups in a final project. Similar to what youâ€™d see in apps like Jamm.

            ![](https://miro.medium.com/max/1260/1\*MmJvPJAqJORM0oEvDZ931A.png)

            So, like any good programmer, I answered in an eloquent and efficient manner that perfectly walked through the concept for them ğŸ‘©â€ğŸ«.

            â€¦and by that I mean, I started googling frantically how to build something like this.

            Alas , with very few results, it was time to set out on my own and see what I could come up with. A few hours and a delicious cheese strudel later, here we are.

            So letâ€™s break down this problem, as there are two parts here.

            1.  We need custom or vanity urls for our invite links to groups.
            2.  We need a way to link these urls to create a group membership for users (signed in and signed out) as well as people who donâ€™t have accounts yet.

            This article will cover part one, for part two youâ€™re on your own âœŒï¸.

            ![](https://miro.medium.com/max/996/0\*DNQLQTRfWbNgVAHk)

            Just kidding, itâ€™s linked at the bottom.

            Anyways, letâ€™s get into building those custom and vanity URLs.

            **The Theory**

            When we normally play with resources in Rails, weâ€™re given something we often take for granted, those nifty idâ€™s generated by our DBs. Not only are these unique per instance, but their presence is guaranteed.

            Now while you may be saying â€œNo duh! Of course idâ€™s generated by a db are going to be unique, as well as present,â€ itâ€™s important to mention, as this same principle will apply to whatever we decide to replace those idâ€™s with, be they usernames as you see on githubâ€¦

            ![](https://miro.medium.com/max/1400/1*_GMFT6LhloLB05Uh6u6D9A.png)

            Or as we saw above with Jamm where they generated an obscure url per group with a token to prevent people from guessing an id number and getting the invitation.

            These parts of the URL, which identify a particular page (or resource) on a website are known as **slugs.** _(â€¦gross I know_ ğŸ¤®_)_

            ![](https://miro.medium.com/max/1000/0\*ZJJwsVgtrWjcTRhL.gif)

            So just like our slug friend above, letâ€™s get to it. To set our URLs up weâ€™ll follow a 4-step process.

            1.  Generate a unique and present slug
            2.  Use that slug as a param in our routes
            3.  Override the ActiveRecord method #to\_param in your model
            4.  Look up records using the slug param you defined from before

            ### _Step 1: Generate a unique and present slug_


            Two approaches to take here. The first is if you are writing a vanity url, for example with a username. In this case, simply add that attribute to your model through a migration or define it during setup, and then add validations to validate presence and uniqueness as below:

            ![](https://miro.medium.com/max/1400/1\*CLBfqLlskPbvDEKFkzGrQg.png)

            The validation is the part you want to focus on, the next article will discuss the has\_many relations

            The other approach is to generate urlâ€™s using long sequences of unique characters, which Iâ€™ll refer to as tokens from here on out, as we saw with Jamm.

            For this approach, I wanted to generate a unique token for each group to be used as the slug . Fortunately, to save us from adding another gem, Rails 5 introduced secure\_token that will take care of generating 24-character unique tokens with minimal setup as can be been below #blessed ğŸ™:

            The first step here is to generate an attribute on our model we want to create these vanity urls for. In our case, for Group, we can do this in two ways, either when we generate the model, or if it already exists, then generate a migration to add the attribute. In either case weâ€™ll need to pass the argument token\_name:token to the generator. Rails will recognize this and set up the correct attribute in our model.

            From there we need to tinker with the model itself as below:

            ![](https://miro.medium.com/max/1400/1\*sBrrQyQezUiSafalCTBR3A.png)

            By applying this has\_secure\_token method with an attribute of my choice my Group model now generates instances of Groups with that 24-character unique token upon save or create.

            And if I ever needed to regenerate my token, all Iâ€™d need to apply is the method #regenerate\_invite\_token to the instance in question.

            See more below in the [documentation](https://api.rubyonrails.org/classes/ActiveRecord/SecureToken/ClassMethods.html) ğŸ‘ˆğŸ»

            Delightful, weâ€™ve got our slug to use, now itâ€™s on to step 2!

            ### _Step 2: Use that slug as a param in our routes_


            By default, Rails will use the :id as the default resource identifier. For us to override that, we simply pass a param option with the attribute weâ€™d like to use in itâ€™s place. In our case of invite links we want to pass the :invite\_token we created in step 1.

            ![](https://miro.medium.com/max/1400/1\*-t0xKUEeLBYVjc8nuQcL2w.png)

            Again donâ€™t worry about the membership or invite\_link stuff, we only care about the param: :invite\_token

            Now when we run rails routeâ€™s weâ€™ll start to see things like this ğŸ”

            ![](https://miro.medium.com/max/1400/1\*0AqQxfeUhkUUVkTMumjyww.png)

            Instead of seeing the traditional :group\_id or :id from before, we now see :group\_invite\_token and :invite\_token in their place.

            [Read more here in the Rails Documentation](https://guides.rubyonrails.org/routing.html#overriding-named-route-parameters)

            ### _Step 3: Override the ActiveRecord method #to\_param in your model_


            Now this is all great, but weâ€™ll still run into a hiccup. If we pass an instance of our model when we try and build a URL, for example with a link\_to, the URL will still be generated with the models :id and NOT the :invite\_token. ğŸ˜­

            This behavior is defined in the #to\_param method in ActiveRecord. Fortunately this behavior is easy to override in your model:

            ![](https://miro.medium.com/max/1400/1\*O4QkqJVPOBJjctafy\_zjww.png)

            By overriding the to\_param method and returning the slug we defined, the routes we generate will change:

            ![](https://miro.medium.com/max/1400/1\*4dwn3FqAFKpg7Um7tbpTmg.png)

            Read a bit more here ğŸ‘‰ [#to\_param](https://apidock.com/rails/ActiveRecord/Integration/to_param)

            ### _Step 4: Look up records using the slug param you defined from before_


            Finally, the last step, we made it fam ğŸ‘¨â€ğŸ‘¨â€ğŸ‘¦ ğŸ‘©â€ğŸ‘©â€ğŸ‘¦ ğŸ‘¨â€ğŸ‘©â€ğŸ‘§

            ![](https://miro.medium.com/max/1000/0\*0Emtu03oTPhBsPJT.gif)

            In our controllers, weâ€™ll often times need to look up and find the resource in question. Minor change here, instead of looking and finding our Model by :ids weâ€™ll instead be finding them through the slug we defined. In our group controller you may see something like this:

            ![](https://miro.medium.com/max/1400/1\*mtv9XIbUnfkr8iIXHGnA4w.png)

            And in any nested resourceâ€™s controllers you may see something like this:

            ![](https://miro.medium.com/max/1400/1\*SrMHrxs6zOWow6ztgWMprg.png)

            And _voila! ğŸ‰_

            We are done, you are now creating custom URLs for your Rails application instead of the boring ones from before!

            In our example we proceeded with setting up a custom URL for a :invite\_token attribute, if youâ€™re in the market for more of a vanity URL such as with :username, just replace :invite\_token with :username or whatever attribute youâ€™d like in the example above.

            For part two, of this little miniseries please check out the article below. Weâ€™ll be using these custom URLs weâ€™ve just set up to create a group memberships for users (signed in and signed out) as well as people who donâ€™t have accounts yet. ğŸ‘‡

            [Passing Referral Codes or Invite Links w/ Devise in Rails](/blog/passing-referral-codes-in-rails)
          </markdown>
        </div>
      </div>
    </div>

    <div class="browser-navbar js-browser-navbar">
      <ul class="browser-navbar__links-list">
        <li><a href="/#browser-skills">SKILLS</a></li>
        <li><a href="/#browser-team">OUR TEAM</a></li>
        <li><a href="/#browser-portfolio">PORTFOLIO</a></li>
        <li><a href="/resources.html">RESOURCES</a></li>
        <li><a href="/blog.html">BLOG</a></li>
        <li><a href="/#browser-contact" class="js-contact-btn">CONTACT</a></li>
        <li class="js-flashlight browser-navbar__flashlight"><a href="#browser-landing">ğŸ”¦</a></li>
      </ul>
    </div>

    <div class="browser-konami-code js-browser-konami-code">
      <p>
        <span>PRESS</span>
        <span>â†‘</span>
        <span>â†‘</span>
        <span>â†“</span>
        <span>â†“</span>
        <span>&larr;</span>
        <span>&rarr;</span>
        <span>â†</span>
        <span>â†’</span>
        <span>b</span>
        <span>a</span>
        <span>FOR</span>
        <span>A</span>
        <span>SURPRISE</span>
        <span>!</span>
      </p>
    </div>

  </div>

  <div class="video-modal js-video-modal">
    <div class="modal-close-icon js-modal-close">
    </div>
    <div class='embed-container'>
      <iframe frameborder='0'
        webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>
    </div>
  </div>

  <!-- ADDING HIGHLIGHT JS -->
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.0.1/styles/default.min.css">

  <!-- ADDING FONT AWESOME -->
  <script src="https://kit.fontawesome.com/721627a3c7.js" crossorigin="anonymous"></script>

  <!-- ADDING GSAP -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.5.1/gsap.min.js"></script>

  <!-- ADDING SCROLLMAGIC.IO -->
  <script src="//cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/ScrollMagic.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/plugins/debug.addIndicators.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/plugins/animation.gsap.min.js"></script>

</body>
</html>


